#无锁框架的结构
##组件
采用一个RingBuffer存储资源/任务
RingBuffer结构会用循环等待的方式同步多个对read指针的同时操作，和多个对write指针的同时操作。但是不同步对read指针和write指针的同时操作，以提高效率。

对于同时操作read指针write指针带来的RingBuffer满，RingBuffer空状态，由下面使用RingBuffer的组件自行处理。


每一个生产者对象Producer中有一个RingBuffer用于存储任务，如果RingBuffer满了，就存储到并发队列中去。

任务分发对象TaskDistributor负责把RingBuffer中的任务取出来放入无锁线程池中。

框架包含一个无锁mysql数据库连接池DBpool，里面存储连接的结构是RingBuffer。

无锁线程池有两种，一种是用于分批执行任务的迭代线程池IterationThreadPool，一种是普通的线程池ThreadPool。

ThreadPool中运行的任务是流水线结构的，即PipelineTask，内含一个Handler列表，每个Handler用于对数据进行处理，可以把数据处理的过程看作数据流过流水线。

ThreadPool中每个线程拥有自己的任务队列，也是RingBuffer结构的。线程池每个线程先检测自己的任务队列是否有任务，如果自己的任务队列为空，则去公用的任务队列（并发队列）中取任务，如果都没有任务，就循环等待50次，最后阻塞。
![](http://i1.piimg.com/567571/4500c6cf5bc57cb2.jpg)